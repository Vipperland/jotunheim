[Module:{"name":"Carousel3D-demo","type":"html"}]
	<div class="panel bg-red full-size" style="backface-visibility:hidden">
		<div class="w-100pc max-height-100pc txt-c scroll-none pos-abs">
			<video class="min-width-100pc b-50pc r-50pc z-0" loop>
			  <source src="assets/media/cover.mp4" type="video/mp4">
			</video>
		</div>
		<div class="disp-table full-size mouse-none">
			<div class="disp-table-cell vert-m txt-c" dyn-value="skip">
			</div>
		</div>
	</div>
	<div class="panel full-size bg-darkred">
		<div class="ref-panel-content">
			<div class="disp-table full-size shadow-txt-x990000">
				<div class="disp-table-cell vert-m txt-c h-100pc" dyn-value="{ love }">
					<div class="legend">
					</div>
					<br/>
					<div class="sub txt-30">
						<span>A profoundly tender, passionate affection for another person.</span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="panel full-size bg-darkorange">
		<div class="ref-panel-content">
			<div class="disp-table full-size shadow-txt-x994400">
				<div class="disp-table-cell vert-m txt-c" dyn-value="{ strenght }">
					<div class="legend">
					</div>
					<br/>
					<div class="sub txt-30">
						<span>The ability to deal with difficult situations or to maintain a moral or intellectual position.</span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="panel full-size bg-yellow">
		<div class="ref-panel-content pos-abs">
			<div class="disp-table full-size shadow-txt-x999900">
				<div class="disp-table-cell vert-m txt-c" dyn-value="{ happyness }">
					<div class="legend">
					</div>
					<br/>
					<div class="sub txt-30">
						<span>Enjoying, showing, or marked by pleasure, satisfaction, or joy.</span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="panel full-size bg-green">
		<div class="ref-panel-content">
			<div class="disp-table full-size shadow-txt-x009900">
				<div class="disp-table-cell vert-m txt-c" dyn-value="{ hope }">
					<div class="legend">
					</div>
					<br/>
					<div class="sub txt-30">
						<span>To wish for a particular event that one considers possible.</span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="panel full-size bg-blue">
		<div class="ref-panel-content">
			<div class="disp-table full-size shadow-txt-x0000AA">
				<div class="disp-table-cell vert-m txt-c" dyn-value="{ healthy }">
					<div class="legend">
					</div>
					<br/>
					<div class="sub txt-30">
						<span>Indicative of sound, rational thinking or frame of mind.</span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="panel full-size bg-indigo">
		<div class="ref-panel-content">
			<div class="disp-table full-size shadow-txt-x000066">
				<div class="disp-table-cell vert-m txt-c" dyn-value="{ harmony }">
					<div class="legend">
					</div>
					<br/>
					<div class="sub txt-30">
						<span>An orderly or pleasing combination of elements in a whole.</span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="panel full-size bg-darkviolet">
		<div class="ref-panel-content">
			<div class="disp-table full-size shadow-txt-x330099">
				<div class="disp-table-cell vert-m txt-c" dyn-value="{ changes }">
					<div class="legend">
					</div>
					<br/>
					<div class="sub txt-30">
						<span>A transformation or transition from one state, condition, or phase to another.</span>
					</div>
				</div>
			</div>
		</div>
	</div>
/EOF;

[Module:{"type":"script"}]
	<script>
		
		Sirius.document.body.bg('#000000');
		
		var Div = sru.dom.Div;
		var Sprite = sru.dom.Sprite;
		var Sprite3D = sru.dom.Sprite3D;
		var Display3D = sru.dom.Display3D;
		var container = null;
		
		function _init3D(){
			
			var main = Sirius.resources.build('Carousel3D-demo');
			Sirius.document.body.addChild(main);
			
			Automator.build('w-100pc h-100pc', '.full-size');
			Automator.build('padd-10 txt-c t-0 w-100pc h-100pc txt-xFFFFFF', '.ref-panel-content');
			Automator.build('ease-background_color-1000ms-linear', '.panel');
			
			container = Sirius.plugins.Carousel3D('.panel', 20, 1000, false);
			
			if(container != null){
			
				// ======= Test keys, Ignore this ;)
				Sirius.document.events.keyDown(function(e){
					switch(e.event.keyCode){
						case 90 : {
							container.toggleAxys();
						}
						case 107 : {}
						case 187 : {
							tg -= 10;
							if(tg < 20) tg = 20;
							re = tg;
							container.update();
							break
						}
						case 109 : {}
						case 189 : {
							tg += 10;
							if(tg > 160) tg = 160;
							re = tg;
							container.update();
							break;
						}
					}
				});
				var re = 120;
				// ======= EOF
				
				// Control panel index highlight
				function onFocusIn(e){
					e.target.data.index.fit(4,4);
					e.target.data.index.style({opacity:.6});
					tg = (e.target.data.control.id == 0) ? 20 : re;
					var text = e.target.one('[dyn-value]');
					if(text){
						var str = text.attribute('dyn-value');
						if(str.length > 0){
							var sp = new Display3D(text);
							if(str != 'skip'){
								sp.one('.legend').write('<span style="font-size:100px">' + str + ' </span>');
							}else{
								sp.write('<img src="assets/img/sirius.png" /><br/><span class="txt-100 txt-xFFFFFF">sirius</span><br/><span class="txt-30 txt-xFFFFFF">dream makers</span>')
							}
							sp.attribute('dyn-value','');
							sp.locationZ(30);
							sp.update();
						}
					}
				}
				
				function onFocusOut(e){
					e.target.data.index.fit(4,4);
					e.target.data.index.style({opacity:.3});
				}
				
				function onPinIn(e){
					e.target.data.index.fit(4,4);
					e.target.data.index.style({opacity:1});
				}
				
				function onPinOut(e){
					e.target.data.index.fit(4,4);
					e.target.data.index.style({opacity:.6});
				}
				
				
				// Create Index
				Automator.build('z-100 t-0 h-100pc padd-8 mouse-none pos-fix','.ref-index');
				Automator.build('padd-t-2 marg-t-4 marg-b-4 shadow-x000000-1-45','.ref-index-obj');
				
				var index = new Sprite();
				index.css('ref-index');
				index.addToBody();
				Dice.All(container.panels, function(p, v){
					var panel = new Div();
					panel.fit(4,4);
					panel.css('ref-index-obj');
					panel.bg('#ffffff');
					panel.style({opacity:.3});
					index.content.addChild(panel);
					v.data.index = panel;
					v.events.auto('carouselFocusIn', onFocusIn);
					v.events.auto('carouselFocusOut', onFocusOut);
					v.events.auto('carouselPinIn', onPinIn);
					v.events.auto('carouselPinOut', onPinOut);
				});
				
				// Update Carousel flipping over time (30 FPS)
				var tg = 20;
				var ap = 20;
				Ticker.add(function(){
					if(ap != tg){
						ap += (tg-ap) * .1;
						container.setAperture(ap);
					}
					console.log(container.aperture);
				});
				
			}
			
			// Config Video Player
			var vid = Sirius.one('video');
			vid.events.click(function(v){ v.target.togglePause(); });
			Sirius.all('video').each(function(v){
				v.play();
			});
			function fitVideo(e){
				vid.style({
					minHeight : Utils.viewportHeight() + 'px'
				});
			}
			Sirius.document.body.events.resize(fitVideo).call();
			
			// Scan body for automator css instructions
			Automator.scan();
			
		}
		
		// Configure shadow direction and strength
		Automator.shadowConfig({distance:3, direction:90, strength:5, flex:.2});
		
		// Inject plugin
		Sirius.inject('sirius/plugins/carousel3d.js', _init3D);
		
	</script>
/EOF;