[Module:{"name":"Carousel3D-demo","type":"html"}]
	<div class="panel bg-red full-size" style="backface-visibility:hidden">
		<div class="w-100pc max-height-100pc txt-c scroll-none pos-abs">
			<video class="min-width-100pc b-50pc r-50pc z-0" loop>
			  <source src="assets/media/cover.mp4" type="video/mp4">
			</video>
		</div>
		<div class="disp-table full-size mouse-none">
			<div class="disp-table-cell vert-m txt-c mouse-none">
				<div id="logo" class="ease-all-linear" sru-dom="DISPLAY3D" xyz>
					<img src="assets/img/sirius.png" /><br/><span class="txt-100 txt-xFFFFFF">sirius</span><br/><span class="txt-30 txt-xFFFFFF">dream makers</span>
				</div>
			</div>
		</div>
	</div>
	<div class="panel full-size bg-x660000">
		<div class="disp-table full-size">
			<div class="disp-table-cell vert-m txt-c">
				<div class="mosaic padd-20 bg-x550000" sru-dom="DISPLAY3D" xyz>
					<div class="cel-12x12 txt-c txt-30 bg-x440000" sru-dom="DISPLAY3D" xyz>
						This is a sample <span class="bold">{Carousel3D}</span> plugin.
					</div>
					<div class="cel-12x12 txt-20">
						Hold keys [-] or [+] to change <span class="bold">{carousel.setAperture(value)}</span>
						<br/>
						Min: 20° / Max: 160°
					</div>
					<div id="aperture" class="cel-12x12 txt-c txt-200" sru-dom="DISPLAY3D" xyz>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="panel full-size bg-xCC6600">
		<div class="disp-table full-size">
			<div class="disp-table-cell vert-m txt-c">
				<div class="mosaic padd-20 bg-xAA5500" sru-dom="DISPLAY3D" xyz>
					<div class="cel-12x12 txt-c txt-30 bg-x994400" sru-dom="DISPLAY3D" xyz>
						Hold keys [&lt;] or [&gt;] to change <span class="bold">{carousel.setZoom(value)}</span>
					</div>
					<div class="cel-12x12 txt-c txt-20">
						Min: 0px / Max: 3000px (in this sample only)
					</div>
					<div id="zoom" class="cel-12x12 txt-c txt-200" sru-dom="DISPLAY3D" xyz>
						1000px
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="panel full-size bg-xAAAA00">
		<div class="disp-table full-size">
			<div class="disp-table-cell vert-m txt-c">
				<div class="mosaic padd-20 bg-x999900" sru-dom="DISPLAY3D" xyz>
					<div class="cel-12x12 txt-c txt-30 bg-x777700" sru-dom="DISPLAY3D" xyz>
						Press key [Z] to change axys <span class="bold">{carousel.toggleAxys(['x'|'y'])}</span>
						
					</div>
					<div class="cel-12x12 txt-c txt-20">
						Available Options: X or Y
					</div>
					<div id="axys" class="cel-12x12 txt-c txt-200" sru-dom="DISPLAY3D" xyz>
						Y
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="panel full-size bg-x00CC00">
		<div class="disp-table full-size">
			<div class="disp-table-cell vert-m txt-c">
				<div class="mosaic padd-20 bg-x00AA00" sru-dom="DISPLAY3D" xyz>
					<div class="cel-12x12 txt-c txt-20 bg-x008800" sru-dom="DISPLAY3D" xyz>
						Press keys [UP] or [DOWN] to change panels
						<br/>
						(enabled by default)
					</div>
					<div class="cel-12x12 txt-c txt-20">
						<span class="bold">{carousel.prevPanel()}</span> or <span class="bold">{carousel.nextPanel()}</span>
					</div>
					<div class="cel-12x12 txt-50">
						<div class="cel-2x12"></div>
						<div id="carousel-prev" class="cel-3x12 txt-c">
							[PREV]
						</div>
						<div class="cel-2x12"></div>
						<div id="carousel-next" class="cel-3x12 txt-c">
							[NEXT]
						</div>
						<div class="cel-2x12"></div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="panel full-size bg-x0066CC">
		<div class="disp-table full-size">
			<div class="disp-table-cell vert-m txt-c">
				<div class="mosaic padd-20 bg-x0044AA" sru-dom="DISPLAY3D" xyz>
					<div class="cel-12x12 txt-c txt-20 bg-x002288" sru-dom="DISPLAY3D" xyz>
						Show Carousel Panel by <span class="bold">{carousel.setPanel(index)}</span><br/>
					</div>
					<div class="cel-12x12 txt-50" sru-dom="DISPLAY3D" xyz>
						<div class="cel-2x12"></div>
						<div set-panel="0" class="cel-1x12 txt-c ref-easing ref-out">
							0
						</div>
						<div set-panel="1" class="cel-1x12 txt-c ref-easing ref-out">
							1
						</div>
						<div set-panel="2" class="cel-1x12 txt-c ref-easing ref-out">
							2
						</div>
						<div set-panel="3" class="cel-1x12 txt-c ref-easing ref-out">
							3
						</div>
						<div set-panel="4" class="cel-1x12 txt-c ref-easing ref-out">
							4
						</div>
						<div set-panel="5" class="cel-1x12 txt-c ref-easing ref-out" sru-dom="DISPLAY3D" xyz>
							[5]
						</div>
						<div set-panel="6" class="cel-1x12 txt-c ref-easing ref-out">
							6
						</div>
						<div set-panel="7" class="cel-1x12 txt-c ref-easing ref-out">
							7
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="panel full-size bg-x0033CC">
		<div class="disp-table full-size">
			<div class="disp-table-cell vert-m txt-c">
				<div class="mosaic padd-20 bg-x0022BB" sru-dom="DISPLAY3D" xyz>
					<div class="cel-12x12 txt-c txt-30 bg-x0011AA" sru-dom="DISPLAY3D" xyz>
						Custom Carousel Events
					</div>
					<div class="cel-12x12 txt-20">
						<div class="cel-4x12"></div>
						<div class="cel-4x12">
							<div id="focusin" class="cel-6x12">
								<span class="bold">{carousel.onZoomIn()}</span>
							</div>
							<div id="focusin" class="cel-6x12">
								<span class="bold">{carousel.onZoomOut()}</span>
							</div>
						</div>
						<div class="cel-4x12"></div>
					</div>
					<div class="cel-12x12 txt-c txt-30 bg-x0011AA" sru-dom="DISPLAY3D" xyz>
						Custom Panel Events
					</div>
					<div class="cel-12x12 txt-20">
						<div class="cel-4x12"></div>
						<div class="cel-4x12">
							<div id="focusin" class="cel-6x12">
								<span class="bold">{carousel.onFocusIn(...)}</span>
							</div>
							<div id="focusin" class="cel-6x12">
								<span class="bold">{carousel.onFocusOut(...)}</span>
							</div>
						</div>
						<div class="cel-4x12"></div>
					</div>
					<div class="cel-12x12 txt-20">
						<div class="cel-4x12"></div>
						<div class="cel-4x12">
							<div id="focusin" class="cel-6x12">
								<span class="bold">{carousel.onPinIn(...)}</span>
							</div>
							<div id="focusin" class="cel-6x12">
								<span class="bold">{carousel.onPinOut(...)}</span>
							</div>
						</div>
						<div class="cel-4x12"></div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="panel full-size bg-x6600CC">
		<div class="disp-table full-size">
			<div class="disp-table-cell vert-m txt-c">
				<div class="mosaic padd-20 bg-x4400AA txt-30" sru-dom="DISPLAY3D" xyz>
					<div class="cel-12x12">
						<a href="">Click here</a> to Download
					</div>
					<div class="cel-12x12 txt-20 txt-l bg-x000022" sru-dom="DISPLAY3D" xyz>
						<div class="cel-3x12"></div>
						<div class="cel-9x12">
							<span class="txt-x00CC66">Sirius</span>.onInit ( <br/>
								<div class="padd-l-30"><span class="txt-x0099FF">function</span> (){</div>
									<div class="padd-l-60"><span class="txt-x0099FF">var</span> myCarousel = <span class="txt-x00CC66">Sirius</span>.plugins.<span class="bold">Carousel3D</span> ( <span class="txt-xFF9900">'myselector'</span> [, <span class="txt-xFF9900">aperture</span>, <span class="txt-xFF9900">maxZoom</span>, <span class="txt-xFF9900">keyboardEnabled</span> ]);</div>
									<div class="padd-l-60 txt-x666666">// ...</div>
								<div class="padd-l-30">},</div>
								<div class="padd-l-30">[<span class="txt-xFF9900">'sirius/carousel3d.min.js'</span>]</div>
							);
						</div>
					</div>
					<div class="cel-12x12 txt-12">Sirius JS API by <a href="mailto:rafael@gateofsirius.com">Rafael Moreira</a></div>
				</div>
			</div>
		</div>
	</div>
	<div id="hint" class="ref-hint ref-easing ref-bottom">
		<img src="/assets/img/scroll.png" />
	</div>
/EOF;

[Module:{"type":"script"}]
	<script>
		
		Sirius.document.body.bg('#000000');
		Sirius.document.body.css('txt-xFFFFFF');
		
		var Div = sru.dom.Div;
		var Sprite = sru.dom.Sprite;
		var Sprite3D = sru.dom.Sprite3D;
		var Display3D = sru.dom.Display3D;
		var carousel3d = null;
		
		function _init3D(){
			
			var main = Sirius.resources.build('Carousel3D-demo');
			Sirius.document.body.addChild(main);
			
			var hint = Sirius.one('#hint');
			var axys = Sirius.one('#axys');
			var zoom = Sirius.one('#zoom');
			
			carousel3d = Sirius.plugins.Carousel3D('.panel', 20, 1000, true);
			
			// Navigation
			Sirius.one('#carousel-prev').events.click( carousel3d.prevPanel );
			Sirius.one('#carousel-next').events.click( carousel3d.nextPanel );
			Sirius.all('[set-panel]').focusOverall( function(e){
				switch(e.event.type){
					case 'mouseover' : {
						e.target.css('ref-in /ref-out');
						break;
					}
					case 'mouseout' : {
						e.target.css('/ref-in ref-out');
						break;
					}
					case 'click' : {
						var p = e.target.attribute('set-panel');
						if(p == '?')
							p = (Math.random()*8)<<0;
						carousel3d.showPanel(p);
						break;
					}
				}
			},2);
			
			if(carousel3d != null){
			
				// ======= Test keys, Ignore this ;)
				Sirius.document.events.keyDown(function(e){
					switch(e.event.keyCode){
						case 90 : {
							carousel3d.toggleAxys();
							axys.clear().write(carousel3d.axys.toUpperCase());
						}
						case 107 : {}
						case 187 : {
							tg += 10;
							if(tg > 160) tg = 160;
							re = tg;
							carousel3d.update();
							break;
						}
						case 109 : {}
						case 189 : {
							tg -= 10;
							if(tg < 20) tg = 20;
							re = tg;
							carousel3d.update();
							break
						}
						case 188 : {
							carousel3d.zoom -= 50;
							if(carousel3d.zoom < 0)
								carousel3d.zoom = 0;
							zoom.clear().write(carousel3d.zoom + 'px');
							break;
						}
						case 190 : {
							carousel3d.zoom += 50;
							if(carousel3d.zoom > 3000)
								carousel3d.zoom = 3000;
							zoom.clear().write(carousel3d.zoom + 'px');
							break
						}
					}
				});
				var re = 120;
				// ======= EOF
				
				// For performance, don't apply xyz tranformation in mobile
				function zPush(o,r){
					if(!Sirius.agent.mobile){
						var tab = o.all('div[xyz]');
						tab.each(function(o){
							if(r){
								o.locationZ(0);
							}else{
								var xyz = parseInt(o.attribute('xyz'));
								o.locationZ(xyz != NaN && xyz > 0 ? xyz : 150);
							}
							o.update();
						});
					}
				}
				
				Sirius.all('div[xyz]').css('ref-easing');
				
				Dice.Values(carousel3d.panels, zPush);
				
				// Control panel index highlight
				function onFocusIn(e){
					var panel = e.target
					panel.data.index.fit(4,4);
					panel.data.index.style({opacity:.6});
					tg = (panel.data.control.id == 0) ? 20 : re;
					if(panel.data.id == 0)
						hint.css('ref-bottom /ref-bottom-hide');
					else
						hint.css('/ref-bottom ref-bottom-hide');
				}
				
				function onFocusOut(e){
					var panel = e.target;
					panel.data.index.fit(4,4);
					panel.data.index.style({opacity:.3});
					
				}
				
				function onPinIn(e){
					var panel = e.target;
					panel.data.index.fit(4,4);
					panel.data.index.style({opacity:1});
					zPush(panel,true);
				}
				
				function onPinOut(e){
					var panel = e.target;
					panel.data.index.fit(4,4);
					panel.data.index.style({opacity:.6});
					zPush(panel,false);
				}
				
				// Create Index
				with(Automator){
					build('w-100pc h-100pc', '.full-size');
					build('z-100 t-0 h-100pc padd-8 pos-fix','.ref-index');
					build('padd-t-2 marg-t-4 marg-b-4 shadow-x000000-1-45','.ref-index-obj');
					build('ease-all-300ms-ease_out','.ref-easing');
					build('b-0','.ref-bottom');
					build('b-100n','.ref-bottom-hide');
					build('pos-fix z-1000 w-100pc txt-c txt-xFFFFFF','.ref-hint');
					build('bg-x0055BB marg-l-1 marg-r-1','.ref-out');
					build('bg-x0099CC marg-l-10 marg-r-10','.ref-in');
					build('bg-x0022BB','.ref-evt-out');
					build('bg-x0055FF','.ref-evt-in');
				}
				
				var index = new Sprite();
				index.css('ref-index mouse-none');
				index.width(20);
				index.addToBody();
				Dice.All(carousel3d.panels, function(p, v){
					var panel = new Div();
					panel.fit(4,4);
					panel.css('ref-index-obj');
					panel.bg('#ffffff');
					panel.style({opacity:.3});
					index.content.addChild(panel);
					v.data.index = panel;
					v.data.id = p;
				});
				
				carousel3d.onFocusIn(onFocusIn);
				carousel3d.onFocusOut(onFocusOut);
				carousel3d.onPinIn(onPinIn);
				carousel3d.onPinOut(onPinOut);
				//carousel3d.onZoomIn(onZoomIn);
				//carousel3d.onZoomOut(onZoomOut);
				
				// Update Carousel flipping over time (30 FPS)
				var tg = 20;
				var ap = 20;
				var aperture = Sirius.one('#aperture');
				
				Ticker.add(function(){
					if(ap != tg){
						ap += (tg-ap) * .1;
						carousel3d.setAperture(ap);
						aperture.clear().write(Math.round(ap) + '°');
					}
				});
				
			}
			
			// Config Video Player
			var vid = Sirius.one('video');
			vid.events.click(function(v){ v.target.togglePause(); });
			Sirius.all('video').each(function(v){
				v.play();
			});
			function fitVideo(e){
				vid.style({
					minHeight : Utils.viewportHeight() + 'px'
				});
			}
			Sirius.document.body.events.resize(fitVideo).call();
			
			// Scan body for automator css instructions
			Automator.scan();
			
		}
		
		// Configure shadow direction and strength
		Automator.shadowConfig({distance:3, direction:90, strength:5, flex:.2});
		
		// Inject plugin
		Sirius.inject('sirius/plugins/carousel3d.js', _init3D);
		
	</script>
/EOF;