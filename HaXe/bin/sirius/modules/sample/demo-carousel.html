[Module:{"name":"Carousel3D-demo","type":"html"}]

<div class="panel h-100pc bg-red w-100pc" style="backface-visibility:hidden">
	<div class="w-100pc max-height-100pc txt-c scroll-none pos-abs">
		<video class="min-width-100pc b-50pc r-50pc z-0" loop>
		  <source src="assets/media/cover.mp4" type="video/mp4">
		</video>
	</div>
	<div class="disp-table w-100pc h-100pc mouse-none">
		<div class="disp-table-cell vert-m txt-c" dyn-value="skip">
		</div>
	</div>
</div>
<div class="panel h-100pc bg-red w-100pc bg-darkred">
	<div class="grid padd-10 txt-white txt-c t-0 w-100pc h-100pc mouse-none">
		<div class="disp-table w-100pc h-100pc">
			<div class="disp-table-cell vert-m txt-c" dyn-value="{love}">
				
			</div>
		</div>
	</div>
</div>
<div class="panel h-100pc bg-orange w-100pc bg-darkorange">
	<div class="grid padd-10 txt-white txt-c t-0 w-100pc h-100pc mouse-none">
		<div class="disp-table w-100pc h-100pc">
			<div class="disp-table-cell vert-m txt-c" dyn-value="{strenght}">
			</div>
		</div>
	</div>
</div>
<div class="panel h-100pc bg-yellow w-100pc bg-yellow">
	<div class="grid padd-10 txt-white txt-c t-0 w-100pc h-100pc mouse-none pos-abs">
		<div class="disp-table w-100pc h-100pc">
			<div class="disp-table-cell vert-m txt-c" dyn-value="{happyness}">
			</div>
		</div>
	</div>
</div>
<div class="panel h-100pc bg-yellowgreen w-100pc bg-green">
	<div class="grid padd-10 txt-white txt-c t-0 w-100pc h-100pc mouse-none">
		<div class="disp-table w-100pc h-100pc">
			<div class="disp-table-cell vert-m txt-c" dyn-value="{hope}">
			</div>
		</div>
	</div>
</div>
<div class="panel h-100pc bg-blue w-100pc bg-blue">
	<div class="grid padd-10 txt-white txt-c t-0 w-100pc h-100pc mouse-none">
		<div class="disp-table w-100pc h-100pc">
			<div class="disp-table-cell vert-m txt-c" dyn-value="{healthy}">
			</div>
		</div>
	</div>
</div>
<div class="panel h-100pc bg-blue w-100pc bg-indigo">
	<div class="grid padd-10 txt-white txt-c t-0 w-100pc h-100pc mouse-none">
		<div class="disp-table w-100pc h-100pc">
			<div class="disp-table-cell vert-m txt-c" dyn-value="{harmony}">
			</div>
		</div>
	</div>
</div>
<div class="panel h-100pc bg-darkviolet w-100pc bg-darkviolet">
	<div class="grid padd-10 txt-white txt-c t-0 w-100pc h-100pc mouse-none">
		<div class="disp-table w-100pc h-100pc">
			<div class="disp-table-cell vert-m txt-c" dyn-value="{changes}">
			</div>
		</div>
	</div>
</div>
	
/EOF;

[Module:{"type":"script"}]

<script>
	
	var Div = sru.dom.Div;
	var Sprite = sru.dom.Sprite;
	var Sprite3D = sru.dom.Sprite3D;
	var Display3D = sru.dom.Display3D;
	var container = null;
	
	function _init3D(){
		
		Sirius.document.body.addChild(Sirius.resources.build('Carousel3D-demo'));
		
		Automator.build('txt-white','*');
		
		container = Sirius.plugins.Carousel3D('.panel', 20, 1000, false);
		
		if(container != null){
		
			Sirius.document.events.keyDown(function(e){
				switch(e.event.keyCode){
					case 90 : {
						container.toggleAxys();
					}
					case 107 : {}
					case 187 : {
						container.aperture -= 10;
						container.update();
						break
					}
					case 109 : {}
					case 189 : {
						container.aperture += 10;
						container.update();
						break;
					}
				}
			});
			
			function onFocusIn(e){
				e.target.data.index.fit(1,4);
				e.target.data.index.style({opacity:.6});
				tg = (e.target.data.control.id == 0) ? 20 : 120;
				var text = e.target.one('[dyn-value]');
				if(text){
					var str = text.attribute('dyn-value');
					if(str.length > 0){
						var sp = new Display3D(text);
						if(str != 'skip') 	sp.write('<span class="txt-white shadow-txt-white" style="font-size:100px">' + str + ' </span>');
						else 				sp.write('<img src="assets/img/sirius.png" /><br/><span class="txt-100 txt-white">sirius</span><br/><span class="txt-30 txt-white">dream makers</span>')
						sp.attribute('dyn-value','');
						sp.locationZ(30);
						sp.update();
					}
				}
			}
			
			function onFocusOut(e){
				e.target.data.index.fit(1,2);
				e.target.data.index.style({opacity:.3});
			}
			
			function onPinIn(e){
				e.target.data.index.fit(1,8);
				e.target.data.index.style({opacity:1});
			}
			
			function onPinOut(e){
				e.target.data.index.fit(1,4);
				e.target.data.index.style({opacity:.6});
			}
			
			
			var index = new Sprite();
			index.css('z-100 t-0 h-100pc padd-8 mouse-none pos-abs');
			index.addToBody();
			
			Dice.All(container.panels, function(p, v){
				var panel = new Div();
				panel.fit(1, 2);
				panel.css('padd-t-2 marg-t-4 marg-b-4');
				panel.background('#ffffff');
				panel.style({opacity:.3});
				index.content.addChild(panel);
				v.data.index = panel;
				v.events.auto('carouselFocusIn', onFocusIn);
				v.events.auto('carouselFocusOut', onFocusOut);
				v.events.auto('carouselPinIn', onPinIn);
				v.events.auto('carouselPinOut', onPinOut);
			});
			
			var tg = 20;
			var ap = 20;
			
			Ticker.add(function(){
				if(ap != tg){
					ap += (tg-ap) * .1;
					container.setAperture(ap);
				}
			});
			
		}
		
		var vid = Sirius.one('video');
		vid.events.click(function(v){ v.target.togglePause(); });
		
		
		Sirius.all('video').each(function(v){
			v.play();
		});
		
		function fitVideo(e){
			vid.style({
				minHeight : Utils.viewportHeight() + 'px'
			});
		}
		
		Sirius.document.body.events.resize(fitVideo);
		fitVideo();
		
		Automator.scan();
		
	}
	
	Sirius.inject('sirius/plugins/carousel3d.min.js', _init3D);
	
</script>