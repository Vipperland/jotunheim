<!DOCTYPE html>
<html lang="pt-BR">
<head class="marg-0">
	<meta charset="utf-8"/>
	<title>Jotun</title>
	<meta name="description" content=""/>
	<style>
		@import url('https://fonts.googleapis.com/css?family=Jura:400,700&display=swap');
		body {
			font-size: 24px;
			color: #FFFFFF;
			background-color: #000000;
		}
		.title {
			padding: 24px;
			font-family: 'Jura', sans-serif;
		}
		.container {
			padding: 10px;
		}
		.dot {
			width:1vw;
			height:1vw;
			max-width: 10px;
			max-height: 10px;
			margin-left:1px;
			margin-bottom:1px;
			background-color:#efefef;
			float:left;
		}
		
		.dot:last-child {
			background-color:#FF0000;
		}
		
		.dot.dead {
			background-color:#FF5555;
		}
		
		.title input {
			border-bottom: 1px solid #efefef;
			padding: 10px 0;
			margin-left: 10px;
			text-align: center;
		}
		
		.life-start {
			padding-left: 10px;
		}
		
		.life-end {
			display: inline-block;
			margin-top: 20px;
		}
		
		.label-start {
			padding: 12px;
			background-color: #009966;
			color: #FFFFFF;
			font-size: 14px;
			border-radius: 10px 10px 10px 0;
			display: inline-block;
		}
		.label-end {
			padding: 12px;
			background-color: #993333;
			color: #FFFFFF;
			font-size: 14px;
			border-radius: 10px 0 10px 10px;
			margin-left: -100%;
			display: inline;
		}
		.flat-border-tl {
			width: 0;
			height: 0;
			border-style: solid;
			border-width: 10px 10px 0 0;
			border-color: #009966 transparent transparent transparent;
		}
		.flat-border-tr {
			width: 0;
			height: 0;
			border-style: solid;
			border-width: 0 0 10px 10px;
			margin-left: -10px;
			margin-bottom: 3px;
			border-color: transparent transparent #993333 transparent;
		}
		.fix {
			clear: both;
			margin-bottom: 50px;
		}
	</style>
</head>
	
<body automator>
	
	<div class="title">
		<div hidden>
			Life Spectance: 
			<input class="years" type="number" min="30" max="120" value="85"/>
		</div>
		Your Birthdate: <input class="birthdate" type="date" />
	</div>
	
	<div>
		<div class="life-start hidden" hidden>
			<div class="label-start">You were born here.</div>
			<div class="flat-border-tl"></div>
		</div>
		<div class="container">
		</div>
		<div class="life-end hidden" hidden>
			<div class="flat-border-tr"></div>
			<div class="label-end">You will die here.</div>
		</div>
	</div>
	
	<div class="fix"></div>
	
	<script src="/jotun/api.jotun.js"></script>
	<script>
		
		function render(){
			
			var years = Jotun.one('input.years').value();
			
			var days = years * 365;
			var weeks = days / 7;
			var lifespan = weeks; 
			
			var current = Jotun.one('input.birthdate').value();
			var now = new Date().getTime();
			var birth = new Date(current).getTime();
			
			if(birth > -2208977612000){
				
				Jotun.one('input.years').show();
				Jotun.one('.life-start').show();
				Jotun.one('.life-end').show();
				
				if(current && birth < now){
					current = (now - birth)/1000/60/60/24/7;
				}else {
					current = 0;
				}
				var res = '';
				Dice.Count(0, lifespan, function(a, b, c){
					res += '<div class="dot' + (a < current ? ' dead' : '') + '"></div>';
				});
				Jotun.one('.container').writeHtml(res);
			}
			
		}
		Jotun.run(function(){
			Jotun.one('input.years').events.change(function(e){
				render();
			});
			Jotun.one('input.birthdate').events.change(function(e){
				render();
			});
		});
	</script>
	
</body>
</html>