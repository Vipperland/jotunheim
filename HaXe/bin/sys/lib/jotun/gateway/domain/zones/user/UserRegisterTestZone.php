<?php
/**
 * Generated by Haxe 4.3.0
 */

namespace jotun\gateway\domain\zones\user;

use \jotun\gateway\domain\zones\ZonePass;
use \jotun\gateway\domain\zones\ZoneServices;
use \php\Boot;
use \jotun\php\db\Clause;
use \jotun\gateway\utils\Validator;

/**
 * ...
 * @author
 */
class UserRegisterTestZone extends ZoneServices {
	/**
	 * @var string
	 */
	public $email;

	/**
	 * @return void
	 */
	public function __construct () {
		#server/jotun/gateway/domain/zones/user/UserRegisterTestZone.hx:19: characters 3-56
		parent::__construct(new ZonePass(0, 1));
	}

	/**
	 * @param string[]|\Array_hx $data
	 * 
	 * @return void
	 */
	public function _execute ($data) {
		#server/jotun/gateway/domain/zones/user/UserRegisterTestZone.hx:28: lines 28-39
		if ($this->loadFromInput()) {
			#server/jotun/gateway/domain/zones/user/UserRegisterTestZone.hx:29: lines 29-38
			if ($this->email !== null) {
				#server/jotun/gateway/domain/zones/user/UserRegisterTestZone.hx:30: lines 30-36
				if (Validator::email($this->email)) {
					#server/jotun/gateway/domain/zones/user/UserRegisterTestZone.hx:31: lines 31-33
					if ($this->get_database()->get_user()->length(Clause::EQUAL("_email", $this->email)) !== 0) {
						#server/jotun/gateway/domain/zones/user/UserRegisterTestZone.hx:32: characters 7-45
						$this->error(101);
					}
				} else {
					#server/jotun/gateway/domain/zones/user/UserRegisterTestZone.hx:35: characters 6-37
					$this->error(100);
				}
			}
		}
	}

	/**
	 * @return bool
	 */
	public function loadFromInput () {
		#server/jotun/gateway/domain/zones/user/UserRegisterTestZone.hx:23: characters 3-29
		$this->email = Boot::dynamicField($this->get_input()->object, 'email');
		#server/jotun/gateway/domain/zones/user/UserRegisterTestZone.hx:24: characters 3-23
		return $this->email !== null;
	}
}

Boot::registerClass(UserRegisterTestZone::class, 'jotun.gateway.domain.zones.user.UserRegisterTestZone');
