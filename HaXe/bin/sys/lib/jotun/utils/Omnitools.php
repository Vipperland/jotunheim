<?php
/**
 * Generated by Haxe 4.3.4
 */

namespace jotun\utils;

use \jotun\serial\Packager;
use \jotun\tools\Key;
use \php\Boot;
use \jotun\math\JMath;
use \php\_Boot\HxString;

/**
 * ...
 * @author
 */
class Omnitools {
	/**
	 * Conver a DD/MM/AAAA date format to unixtime
	 * @param	date
	 * @return
	 * 
	 * @param string $date
	 * 
	 * @return float
	 */
	public static function dmYToUnixtime ($date) {
		#src/jotun/utils/Omnitools.hx:61: lines 61-70
		if (($date !== null) && (mb_strlen($date) === 10)) {
			#src/jotun/utils/Omnitools.hx:62: characters 4-66
			$darr = HxString::split(HxString::split($date, "/")->join("-"), "-");
			#src/jotun/utils/Omnitools.hx:63: lines 63-65
			if (mb_strlen(($darr->arr[0] ?? null)) !== 4) {
				#src/jotun/utils/Omnitools.hx:64: characters 5-19
				$darr->arr = \array_reverse($darr->arr);
			}
			#src/jotun/utils/Omnitools.hx:66: characters 4-25
			$date = $darr->join("-");
			#src/jotun/utils/Omnitools.hx:67: characters 4-42
			return \Date::fromString($date)->getTime();
		} else {
			#src/jotun/utils/Omnitools.hx:69: characters 4-12
			return 0;
		}
	}

	/**
	 * Create a unique random 32 length string
	 * @return
	 * 
	 * @return string
	 */
	public static function genRandomIDx32 () {
		#src/jotun/utils/Omnitools.hx:43: characters 3-59
		return Packager::md5Encode((Key::GEN(16)??'null') . "." . (Omnitools::timeNow()??'null'));
	}

	/**
	 * Create a unique random 32 length string
	 * @return
	 * 
	 * @return string
	 */
	public static function genRandomIDx65 () {
		#src/jotun/utils/Omnitools.hx:35: characters 3-79
		return (Packager::md5Encode(Key::GEN(32))??'null') . "." . (Packager::md5Encode(Omnitools::timeNow())??'null');
	}

	/**
	 * If elapsed date is greater or equal to 18 years
	 * @param	time
	 * @return
	 * 
	 * @param float $time
	 * 
	 * @return bool
	 */
	public static function testBirthdate ($time) {
		#src/jotun/utils/Omnitools.hx:52: characters 3-35
		return JMath::calcAge($time) >= 18;
	}

	/**
	 * Servertime + hours offset
	 * @param	hours
	 * @return
	 * 
	 * @param float $hours
	 * 
	 * @return float
	 */
	public static function timeFromNow ($hours) {
		#src/jotun/utils/Omnitools.hx:27: characters 3-38
		return Omnitools::timeNow() + $hours * 360000;
	}

	/**
	 * Servertime
	 * @return
	 * 
	 * @return float
	 */
	public static function timeNow () {
		#src/jotun/utils/Omnitools.hx:18: characters 3-30
		return \Date::now()->getTime();
	}
}

Boot::registerClass(Omnitools::class, 'jotun.utils.Omnitools');
